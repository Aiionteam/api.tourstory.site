# tour.site - 클라우드 배포용
# Neon DB, Upstash Redis는 이미 클라우드에 있으므로 Gateway만 실행합니다.
# 환경 변수는 프로젝트 루트의 .env 파일을 사용합니다.

services:
  gateway:
    build:
      context: .
      dockerfile: gateway/Dockerfile
    image: tour-site-gateway:latest
    container_name: tour-site-gateway
    env_file:
      - .env
    environment:
      SPRING_PROFILES_ACTIVE: local
    ports:
      - "8080:8080"
    restart: unless-stopped
    # Upstash 등 외부 호스트명 해석을 위해 DNS 지정 (컨테이너 내 Name does not resolve 방지)
    dns:
      - 8.8.8.8
      - 8.8.4.4
    # healthcheck: Alpine 이미지에 curl/wget이 없을 수 있어 비활성화. 필요 시 Dockerfile에 추가 후 사용
